---
title: "CBA of Carbon Sequestration Potential of Kelp"
author: "Natalie Smith"
format: html
editor: visual
---

# Introduction:

Carbon sequestration on natural and working lands (NWL) has great poten- tial, but most carbon markets exclude NWL. In this homework you will do a cost benefit analysis of kelp farming to sequester carbon for a carbon market. Because this is a relatively new industry, you will conduct the analysis under uncertainty. Kelp farming is common in many parts of Asia and you will analyze the costs and benefits of a kelp farm to sequester carbon for the emerging Chinese carbon market. Consider a 1 hectare kelp farm, which has the following attributes (all monetary units are dollars):

[Costs:]{.underline}

-   The setup cost of the farm is C, which has to be paid today
-   The maintenance cost of the farm is D per year

Kelp Growth

-   When the farm is started, the kelp biomass is 1 ton.
-   Time is measured in years. At the beginning of year t + 1, the kelp biomass is: 
$$
    B(t+1) = B(t) + wB(t)(1-B(t)/K)
$$

Where, w is a growth rate parameter and K is the carrying capacity of kelp on a 1 hectare kelp farm. B(t) is measured in tons of biomass.

[Benefits:]{.underline}

-   Kelp sequesters carbon. The higher the biomass of kelp, the more carbon it sequesters. In this location, each ton of kelp biomass sequesters s tons of carbon per year. (For example, if s = .3 and the farm has 2 tons of kelp biomass, then the farm sequesters .6 tons of carbon that year.)
-   The kelp farmer can sell carbon credits for sequestered carbon at a price of p per ton.

# Questions:
```{r}
library(here)
library(tidyverse)
```


## 1)

*Use the following parameters: C =\$10,000, D =\$1,000, w = .5, K = 100, s = .5, and p =\$40. The discount rate is r = .05.*

### a)

Write a program in R that simulates the biomass of kelp over time. Make a plot of biomass over time for 20 years.

```{r}
# B(t+1) = B(t) + wB(t)(1 - B(t)/K)
# Set parameters
# b = biomass
n_time <- 20
w <- 0.5  # growth rate
k <- 100  # carrying capacity

# Define function for biomass growth
simulate_biomass <- function(initial_biomass = 1, n_time, w, k) {
  biomass <- numeric(n_time)
  biomass[1] <- initial_biomass

  # Run a for loop to simulate biomass for each year based on the biomass from the previous year
  # Using n_time - 1 ensures that we can calculate up to the last element of the biomass vector without exceeding its bounds
  for (t in seq_len(n_time - 1)) {
    biomass[t + 1] <- biomass[t] + w * biomass[t] * (1 - biomass[t] / k)
  }
  return(biomass)
}

# Run the function 
biomass_over_time <- simulate_biomass(initial_biomass = 1, n_time = n_time, w = w, k = k)

# Create a data frame
biomass_df <- data.frame(
  year = 1:n_time,
  biomass = biomass_over_time
)

# Load ggplot2 library
library(ggplot2)

# Plot it
ggplot(biomass_df, aes(x = year, y = biomass)) +
  geom_point(color = "dodgerblue") +
  geom_line(color = "dodgerblue") +
  labs(x = "Time (years)",
       y = "Biomass (tons)",
       title = "Kelp Biomass Growth Over Time") +
  theme_minimal()

```


### b)

In year t = 10 what is the biomass of kelp? How much carbon is sequestered that year? What is the value of carbon credits the kelp farmer can sell that year?

```{r}
#get biomass for year 10
biomass_year_10 <- biomass_over_time[10]
biomass_year_10

#carbon sequestered = biomass * carbon sequestration rate (0.5)
s <- 0.5
carbon_sequestered_year_10 <- biomass_year_10 * s
carbon_sequestered_year_10 #tons

#value of carbon credits farmer can sell that year
#carbon credits = carbon sequestered * price per ton of carbon
price_per_ton_year_10 <- 40 #USD
value_carbon_credit_year_10 <- carbon_sequestered_year_10 * price_per_ton_year_10 
value_carbon_credit_year_10

```


### c)

Plot the value of carbon credits sold against time.

### d)

Plot the present value of carbon credits sold against time.

### e)

Compare the sum of present value of costs against the sum of present value of benefits over a 50 year horizon. Do the benefits of the farm outweigh the costs?

### f)

The Chinese government is considering raising the carbon price (p). What value of p would make kelp farmers exactly break even (so present value of benefits equals present value of costs)?

## 2)

Now supposes that you are uncertain about the parameters w (growth rate of kelp), s (carbon sequestration parameter), and p (carbon price). You believe the parameters are drawn from the following distributions:

-   w is Normally distributed with mean .5 and standard deviation .2
-   s is either .4, .5, or .6 (with equal probabilities)
-   p is Normally distributed with mean 40 and standard deviation 15

### a)

Write a function in R that takes any value of w, s, and p as inputs and returns the Present value of Benefits minus the present value of Costs (keeping other parameters at their values from above)

### b)

Call that function for the values w = .5, s = .5, and p = 40. What is the result?

### c)

Have R generate one value of w, s, and p from the distributions described above. Call your function for those values and show the result.

### d)

Write an R program that draws 1,000 different combinations of w, s, and p from their respective distributions, and calls your function for each set of values. Plot a histogram of the final results.

### e)

Using these distributions, what is the probability that the kelp farm will have positive net present value of benefits? What is the probability that the net present value of benefits will be larger than \$5,000?
