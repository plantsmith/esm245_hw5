---
title: "CBA of Carbon Sequestration Potential of Kelp"
author: "Natalie Smith"
format: html
editor: visual
---

# Introduction:

Carbon sequestration on natural and working lands (NWL) has great poten- tial, but most carbon markets exclude NWL. In this homework you will do a cost benefit analysis of kelp farming to sequester carbon for a carbon market. Because this is a relatively new industry, you will conduct the analysis under uncertainty. Kelp farming is common in many parts of Asia and you will analyze the costs and benefits of a kelp farm to sequester carbon for the emerging Chinese carbon market. Consider a 1 hectare kelp farm, which has the following attributes (all monetary units are dollars):

[Costs:]{.underline}

-   The setup cost of the farm is C, which has to be paid today
-   The maintenance cost of the farm is D per year

Kelp Growth

-   When the farm is started, the kelp biomass is 1 ton.
-   Time is measured in years. At the beginning of year t + 1, the kelp biomass is: 
$$
    B(t+1) = B(t) + wB(t)(1-B(t)/K)
$$

Where, w is a growth rate parameter and K is the carrying capacity of kelp on a 1 hectare kelp farm. B(t) is measured in tons of biomass.

[Benefits:]{.underline}

-   Kelp sequesters carbon. The higher is the biomass of kelp, the more carbon it sequesters. In this location, each ton of kelp biomass sequesters s tons of carbon per year. (For example, if s = .3 and the farm has 2 tons of kelp biomass, then the farm sequesters .6 tons of carbon that year.)
-   The kelp farmer can sell carbon credits for sequestered carbon at a price of p per ton.

# Questions:
```{r}
library(here)
library(tidyverse)
```


## 1)

*Use the following parameters: C =\$10,000, D =\$1,000, w = .5, K = 100, s = .5, and p =\$40. The discount rate is r = .05.*

### a)

Write a program in R that simulates the biomass of kelp over time. Make a plot of biomass over time for 20 years.

```{r}
#set parameters
w <- 0.5      # growth rate parameter
k <- 100      # carrying capacity, max each farm can sustain
n_time <- 20  # time horizon for simulation

#function to simulate biomass over time
simulate_biomass <- function(initial_biomass, w, k, time_horizon) {
  biomass <- numeric(time_horizon)  #create biomass vector to store kelp biomass values for each year
  biomass[1] <- initial_biomass    #initial biomass of kelp; set to 1 ton
  
#run a for loop to simulate biomass over time
#(start at n_time minus 1 bc biomass[t + 1] depends on the previous yearâ€™s biomass)
  for (t in seq_len(time_horizon - 1)) { 
    biomass[t + 1] <- biomass[t] + w * biomass[t] * (1 - biomass[t] / k)
  }
  
  return(biomass)
}

#run the function
biomass_over_time <- simulate_biomass(initial_biomass = 1, w = w, k = k, time_horizon = n_time)

#create a df 
biomass_data <- data.frame(
  Year = 1:n_time,
  Biomass = biomass_over_time)

#plot biomass over time using ggplot2
ggplot(biomass_data, aes(x = Year, y = Biomass)) +
  geom_line(color = "dodgerblue")+   # Line for biomass
  geom_point(color = "dodgerblue")+  # Points for each year
  labs(x = "Time (years)", y = "Biomass (tons)", title = "Kelp Biomass Growth Over Time") +
  theme_minimal()
```


### b)

In year t = 10 what is the biomass of kelp? How much carbon is sequestered that year? What is the value of carbon credits the kelp farmer can sell that year?

### c)

Plot the value of carbon credits sold against time.

### d)

Plot the present value of carbon credits sold against time.

### e)

Compare the sum of present value of costs against the sum of present value of benefits over a 50 year horizon. Do the benefits of the farm outweigh the costs?

### f)

The Chinese government is considering raising the carbon price (p). What value of p would make kelp farmers exactly break even (so present value of benefits equals present value of costs)?

## 2)

Now supposes that you are uncertain about the parameters w (growth rate of kelp), s (carbon sequestration parameter), and p (carbon price). You believe the parameters are drawn from the following distributions:

-   w is Normally distributed with mean .5 and standard deviation .2
-   s is either .4, .5, or .6 (with equal probabilities)
-   p is Normally distributed with mean 40 and standard deviation 15

### a)

Write a function in R that takes any value of w, s, and p as inputs and returns the Present value of Benefits minus the present value of Costs (keeping other parameters at their values from above)

### b)

Call that function for the values w = .5, s = .5, and p = 40. What is the result?

### c)

Have R generate one value of w, s, and p from the distributions described above. Call your function for those values and show the result.

### d)

Write an R program that draws 1,000 different combinations of w, s, and p from their respective distributions, and calls your function for each set of values. Plot a histogram of the final results.

### e)

Using these distributions, what is the probability that the kelp farm will have positive net present value of benefits? What is the probability that the net present value of benefits will be larger than \$5,000?
